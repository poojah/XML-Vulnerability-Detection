<?php

//create document root
$doc = new DOMDocument("1.0");
$doc->saveXML();
$root = $doc->createElement("article");
$root = $doc->appendChild($root);

//add ID attribute
$id=$_POST['id'];
$root->setAttribute('id', $id);

//create headline
$head = $doc->createElement("headline");
$head = $root->appendChild($head);
$headline=$_POST['headline'];
$htext = $doc->createTextNode($headline);
$htext = $head->appendChild($htext);

//create author name
$name=$_POST['name'];
$aname = $doc->createElement("author");
$aname = $root->appendChild($aname);
$atext = $doc->createTextNode($name);
$atext = $aname->appendChild($atext);

//create author email
$email=$_POST['email'];
$mail = $doc->createElement("email");
$mail = $root->appendChild($mail);
$mtext = $doc->createTextNode($email);
$mtext = $mail->appendChild($mtext);

//create abstract
$abstract=$_POST['abstract'];
$abs = $doc->createElement("abstract");
$abs = $root->appendChild($abs);
$abstext = $doc->createTextNode($abstract);
$abstext = $abs->appendChild($abstext);

//create keyword listing
$keywords=$_POST['keywords'];
$keylisting = $doc->createElement("keywords");
$keylisting = $root->appendChild($keylisting);
$ktext = $doc->createTextNode($keywords);
$ktext = $keylisting->appendChild($ktext);

//create status, always in progress when first created
//$stat = $doc->create_element("status");
//$stat = $root->append_child($stat);
//$stat_text = $doc->create_text_node($status);
//$stat_text = $stat->append_child($stat_text);


//create paras
if (is_array($body)){
	foreach ($body as $K => $V){
		
		if ($V != ""){
			$V = stripslashes($V);
			$para = $doc->createElement("para-$K");
			$para = $root->appendChild($para);
			$ptext = $doc->createTextNode($V);
			$ptext = $para->appendChild($ptext);
		}
	}
}



//write to the file (first delete existing one!)
$filename = "./xml/".$id . ".xml";
unlink($filename);
$doc->save($filename);

//send user back to adminindex
header("Location:adminindex.php");
?>