<?php


function extractText($array){
	if(count($array) <= 1){
		//we only have one tag to process!
		for ($i = 0; $i<count($array); $i++){
			$node = $array->item($i);
			$value = $node->nodeValue;
		}
		return $value;
	} 
	
}	
?>

<html>
<head>
<title>Welcome to XMLTEST</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body>
<h1>Welcome to the XMLTEST site</h1>
<p><br>
  <a href="adminindex.php">Admin Login</a> </p>
<form name="search" method="post" action="searchArticles.php">
  Search articles: 
  <input name="searchTerm" type="text" id="searchTerm">
  <input name="Search" type="submit" id="Search" value="Search">
</form>
<p>The following articles are available: </p>
<table border=1 cellspacing=0 cellpadding=2 width=500>
<?php
$dh = opendir('./xml/');

$fileCount = 0;
while ($file = readdir($dh) and $fileCount < 5){
	if (preg_match("/^..?$/", $file)) {
		continue;
	}
	$open = "./xml/".$file;
	$xml = new DomDocument;
	@$xml ->load($open);

	//we need to pull out all the things from this file that we will need to 
	//build our links
	$root = $xml->documentElement;
	//$stat_array = $root->getElementsByTagname("status");
	//$status = extractText($stat_array);
	
	
	
	$ab_array = $root->getElementsByTagname("abstract");
	$abstract = extractText($ab_array);
	
	$h_array = $root->getElementsByTagname("headline");
	$headline = extractText($h_array);
	

//	if ($status != "live"){
//		continue;
//	}
	echo "<tr valign=top><td>";
	
	echo "<a href=\"showArticle.php?file=$file \">".$headline . "</a><br>";
	echo $abstract;
	echo "</td></tr>";
	
	$fileCount++;
}
?>
</table>

<br><a href="adminindex.php">Admin Login</a>
</body>
</html>
